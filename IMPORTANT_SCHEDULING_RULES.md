# 重要排班算法规则

**以下规则是排班算法的核心原则，任何代码修改都必须严格遵守，不得随意更改！**

## 1. 班次启用状态要求
**所有的用于排班的班次必须是启用状态。**
- 算法只能从启用的班次中选择进行排班
- 未启用的班次不会被考虑用于任何排班安排

## 2. 班次优先级规则
**用于排班的班次的优先级是由班次管理中priority的排班顺序来决定的。**
- 优先级值越小，表示班次优先级越高
- 排班算法在选择班次时，会优先考虑优先级高的班次
- 优先级通过`getSortedShiftsByPriority`方法实现

## 3. 岗位特殊班次唯一性
**同一个特殊班次在同一个岗位、同一天里只会有一个人值班。**
- 通过`weekendPositionAssignments`对象进行跟踪
- 确保同一岗位在同一天内不会安排多个相同的特殊班次
- 该限制主要适用于周末排班

## 4. 特殊班次连值天数要求
**有些特殊班次要遵循有连值天数的要求。**
- 不同班次有不同的最大连值天数限制
  - Y16综：最多连值7天
  - G班：最多连值7天
  - 其他班次：最多连值5天
- 连值天数通过`consecutiveShiftDays`对象进行跟踪

## 5. 连值结束后必须轮换
**同一个特殊班次在值完要求的连值天数后不可能再接着值这个班次，应该换下一个人。**
- 当员工连续值同一特殊班次达到最大限制天数后，必须换其他员工
- 系统会自动查找排班顺序中的下一位员工

## 6. 排班人员顺序规则
**班次排班人员的顺序依据排班顺序管理中的班次的人员排序。**
- 通过`getEmployeePositionInOrder`方法确定员工在排班顺序中的位置
- 排班时会优先考虑排班顺序中应该轮到的员工
- 对于G值类型班次，会特别查找上一次值相同类型班次的员工，然后选择下一位

## 7. G值班次时间限制
**G值、G值-A、G值-B、G值-C这四个只能安排在周末。**
- 这些班次在工作日不会被安排
- 每个G值班次还有特定的安排规则：
  - G值-C：只能在周六安排，不能在周日安排
  - G值-A和G值-B：周日安排时，必须周六也安排了相同班次
  - 同一个员工不能连续两个周末都值G值周末班

---

**创建时间：** `2025-09-11`
**重要性：** ⭐⭐⭐⭐⭐（核心规则，任何修改都必须保持兼容性）